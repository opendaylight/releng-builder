- project:
    name: neutron-daily-openstack
    jobs:
        - 'neutron-daily-openstack-beryllium'

    project: 'neutron'

- job-template:
    name: 'neutron-daily-openstack-beryllium'

    project-type: freestyle
    node: dynamic_devstack
    description: 'Jenkins job to run Tempest tests for the ODL ML2 MechanismDriver on Neutron dummy provider. '
    concurrent: true

    logrotate:
        daysToKeep: '198'

    parameters:
        - project-parameter:
            project: '{project}'

    wrappers:
        - timeout:
            fail: true
            timeout: 90
            timeout-var: 'BUILD_TIMEOUT'
            type: absolute
        - ssh-agent-credentials:
            users:
                - '{openstack-gerrit-credentials}'
        - jclouds:
            single-use: true

    triggers:
        - timed: '@daily'

    builders:
        - inject:
            properties-content: |
              ODL_VERSION=lithium-latest
              TEMPEST_REGEX=tempest.api.network
              KARAFFEATURE=odl-neutron-dummyprovider-test
        - shell:
            !include-raw-escape:
                - include-raw-openstack-ci.sh

    publishers:
        - archive:
            artifacts: 'logs/**'
            fingerprint: false
        - email-ext:
            subject: '[neutron] $DEFAULT_SUBJECT'
            attach-build-log: false
            failure: false
            unstable: false
            fixed: false
