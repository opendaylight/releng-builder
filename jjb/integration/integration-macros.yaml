- parameter:
    name: integration-bundleurl
    parameters:
        - string:
            name: BUNDLEURL
            default: '{bundleurl}'
            description: 'URL to karaf distribution zip'

- parameter:
    name: integration-controller-scope
    parameters:
        - string:
            name: CONTROLLERSCOPE
            default: '{controller-scope}'
            description: 'Feature Only or Feature All test'

- parameter:
    name: integration-controller-features
    parameters:
        - string:
            name: CONTROLLERFEATURES
            default: '{controller-features}'
            description: 'Features to install in the controller separated by comma'

- parameter:
    name: integration-test-plan
    parameters:
        - string:
            name: TESTPLAN
            default: '{test-plan}'
            description:  'Test plan we will run'

- parameter:
    name: integration-test-options
    parameters:
        - string:
            name: TESTOPTIONS
            default: '{test-options}'
            description:  'Robot command options'

- wrapper:
    name: integration-jclouds-controller-mininet
    wrappers:
      - jclouds:
          instances:
            - rk-c-el6-java:
                cloud-name: 'Rackspace DFW - Integration'
                count: '{controller-vms}'
                stop-on-terminate: False
            - rk-c-el6-mininet:
                cloud-name: 'Rackspace DFW - Integration'
                count: '{mininet-vms}'
                stop-on-terminate: False

#################
# Shell Scripts #
#################

- builder:
    name: integration-get-slave-addresses
    builders:
        - shell:
            !include-raw include-raw-integration-get-slave-addresses.sh

- builder:
    name: integration-deploy-controller-run-test
    builders:
        - shell:
            !include-raw include-raw-integration-deploy-controller-run-test.sh

##############
# Publishers #
##############

- publisher:
    name: integration-robot
    publishers:
        - robot:
            output-path: ''
            other-files: ''
            unstable-threshold: '{unstable-if}'
            pass-threshold: '{pass-if}'
            only-critical: false
