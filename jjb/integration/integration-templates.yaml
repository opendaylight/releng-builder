# Job templates in this file (please update with every new template):
#
# New (for Be release):
# {project}-csit-verify-1node-{functionality}
# {project}-csit-1node-{functionality}-{install}-{stream}
# {project}-csit-1node-periodic-{functionality}-{install}-{stream}
# {project}-csit-verify-3node-{functionality}
# {project}-csit-3node-{functionality}-{install}-{stream}
# {project}-csit-3node-periodic-{functionality}-{install}-{stream}
#
# Parameters:
#
# project-parameter: main project integration/test ($PROJECT)
# jre: (openjdk7 or openjdk8) Java runtime environment to use when launching ODL
# integration-branch: distribution branch ($BRANCH)
# integration-controller-bundleurl: distribution URL ($BUNDLEURL)
# integration-controller-scope: only or all features ($CONTROLLERSCOPE)
# integration-controller-features: features under test ($CONTROLLER FEATURES)
# integration-test-options: robot options ($TESTOPTIONS)
# integration-stream-test-plan: stream specific robot test plan ($STREAMTESTPLAN)
# integration-test-plan: fallback robot test plan ($TESTPLAN)
# integration-patch-refspec: test branch ($PATCHREFSPEC)


# New templates

- job-template:
    name: '{project}-csit-verify-1node-{functionality}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: 'stable/beryllium'
        - integration-distribution-stream:
            stream: 'beryllium'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-scope:
            controller-scope: 'only'
        - integration-controller-features:
            controller-features: '{install-features}'
        - integration-test-options:
            test-options: '{robot-options}'
        - integration-stream-test-plan:
            stream-test-plan: '{project}-{functionality}-beryllium.txt'
        - integration-test-plan:
            test-plan: '{project}-{functionality}.txt'
        - integration-jdk-version:
            jdkversion: 'openjdk7'
            # TODO: Switch to openjdk8 from Boron on.

    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$GERRIT_REFSPEC'
            branch: 'master'

    wrappers:
        - build-timeout
        - integration-openstack-controller-mininet:
            controller-vms: 1
            mininet-image: '{mininet-image}'
            mininet-vms: '{mininet-vms}'
            mininet-cloud-name: '{mininet-cloud-name}'
        - ssh-agent-credentials:
            users:
                - '{ssh-credentials}'

    triggers:
        - integration-trigger-patch-submitted:
            name: 'integration/test'
            branch: 'master'
            pattern: 'csit/suites/{project}/**'

    builders:
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-deploy-controller-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*.log,*.log.xz,*.csv'
        - email-notification:
            email-prefix: '[{project}]'

- job-template:
    name: '{project}-csit-1node-{functionality}-{install}-{stream}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: '{branch}'
        - integration-distribution-stream:
            stream: '{stream}'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-scope:
            controller-scope: '{scope}'
        - integration-controller-features:
            controller-features: '{install-features}'
        - integration-test-options:
            test-options: '{robot-options}'
        - integration-stream-test-plan:
            stream-test-plan: '{project}-{functionality}-{stream}.txt'
        - integration-test-plan:
            test-plan: '{project}-{functionality}.txt'
        - integration-patch-refspec:
            branch: 'master'
        - integration-jdk-version:
            jdkversion: '{jre}'

    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$PATCHREFSPEC'
            branch: 'master'

    wrappers:
        - build-timeout
        - integration-openstack-controller-mininet:
            controller-vms: 1
            mininet-image: '{mininet-image}'
            mininet-vms: '{mininet-vms}'
            mininet-cloud-name: '{mininet-cloud-name}'
        - ssh-agent-credentials:
            users:
                - '{ssh-credentials}'

    triggers:
        - integration-csit-{install}:
            jobs: '{trigger-jobs}'

    builders:
        - integration-copy-ssh-keys
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-deploy-controller-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*.log,*.log.xz,*.csv'
        - email-notification:
            email-prefix: '[{project}]'
        - plot:
          - title: '{01-plot-title}'
            yaxis: '{01-plot-yaxis}'
            group: '{01-plot-group}'
            num-builds: '5400'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-1node-{functionality}-{install}-{stream}-{01-plot-data-file}-history.csv'
            series:
              - file: '{01-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv
          - title: '{02-plot-title}'
            yaxis: '{02-plot-yaxis}'
            group: '{02-plot-group}'
            num-builds: '5400'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-1node-{functionality}-{install}-{stream}-{02-plot-data-file}-history.csv'
            series:
              - file: '{02-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv

- job-template:
    name: '{project}-csit-1node-periodic-{functionality}-{install}-{stream}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: '{branch}'
        - integration-distribution-stream:
            stream: '{stream}'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-scope:
            controller-scope: '{scope}'
        - integration-controller-features:
            controller-features: '{install-features}'
        - integration-test-options:
            test-options: '{robot-options}'
        - integration-stream-test-plan:
            stream-test-plan: '{project}-{functionality}-{stream}.txt'
        - integration-test-plan:
            test-plan: '{project}-{functionality}.txt'
        - integration-patch-refspec:
            branch: 'master'
        - integration-jdk-version:
            jdkversion: '{jre}'

    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$PATCHREFSPEC'
            branch: 'master'

    wrappers:
        - integration-openstack-controller-mininet:
            controller-vms: 1
            mininet-image: '{mininet-image}'
            mininet-vms: '{mininet-vms}'
            mininet-cloud-name: '{mininet-cloud-name}'
        - ssh-agent-credentials:
            users:
                - '{ssh-credentials}'

    triggers:
        - timed: '{schedule}'

    builders:
        - integration-copy-ssh-keys
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-deploy-controller-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*.log,*.log.xz,*.csv'
        - email-notification:
            email-prefix: '[{project}]'
        - plot:
          - title: '{01-plot-title}'
            yaxis: '{01-plot-yaxis}'
            group: '{01-plot-group}'
            num-builds: '180'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-periodic-1node-{functionality}-{install}-{stream}-{01-plot-data-file}-history.csv'
            series:
              - file: '{01-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv
          - title: '{02-plot-title}'
            yaxis: '{02-plot-yaxis}'
            group: '{02-plot-group}'
            num-builds: '180'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-periodic-1node-{functionality}-{install}-{stream}-{02-plot-data-file}-history.csv'
            series:
              - file: '{02-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv

- job-template:
    name: '{project}-csit-verify-3node-{functionality}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: 'stable/beryllium'
        - integration-distribution-stream:
            stream: 'beryllium'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-scope:
            controller-scope: 'only'
        - integration-controller-features:
            controller-features: 'odl-jolokia,{install-features}'
        - integration-test-options:
            test-options: '{robot-options}'
        - integration-stream-test-plan:
            stream-test-plan: '{project}-{functionality}-beryllium.txt'
        - integration-test-plan:
            test-plan: '{project}-{functionality}.txt'
        - integration-jdk-version:
            jdkversion: 'openjdk7'
            # TODO: Switch to openjdk8 from Boron on.

    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$GERRIT_REFSPEC'
            branch: 'master'

    wrappers:
        - build-timeout
        - integration-openstack-controller-mininet:
            controller-vms: 3
            mininet-image: '{mininet-image}'
            mininet-vms: '{mininet-vms}'
            mininet-cloud-name: '{mininet-cloud-name}'
        - ssh-agent-credentials:
            users:
                - '{ssh-credentials}'

    triggers:
        - integration-trigger-patch-submitted:
            name: 'integration/test'
            branch: 'master'
            pattern: 'csit/suites/{project}/**'

    builders:
        - integration-copy-ssh-keys
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-configure-clustering
        - integration-start-cluster-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*.log,*.log.xz,*.csv'
        - email-notification:
            email-prefix: '[{project}]'

- job-template:
    name: '{project}-csit-3node-{functionality}-{install}-{stream}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: '{branch}'
        - integration-distribution-stream:
            stream: '{stream}'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-scope:
            controller-scope: '{scope}'
        - integration-controller-features:
            controller-features: 'odl-jolokia,{install-features}'
        - integration-test-options:
            test-options: '{robot-options}'
        - integration-stream-test-plan:
            stream-test-plan: '{project}-{functionality}-{stream}.txt'
        - integration-test-plan:
            test-plan: '{project}-{functionality}.txt'
        - integration-patch-refspec:
            branch: 'master'
        - integration-jdk-version:
            jdkversion: '{jre}'

    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$PATCHREFSPEC'
            branch: 'master'

    wrappers:
        - build-timeout
        - integration-openstack-controller-mininet:
            controller-vms: 3
            mininet-image: '{mininet-image}'
            mininet-vms: '{mininet-vms}'
            mininet-cloud-name: '{mininet-cloud-name}'
        - ssh-agent-credentials:
            users:
                - '{ssh-credentials}'

    triggers:
        - integration-csit-{install}:
            jobs: '{trigger-jobs}'

    builders:
        - integration-copy-ssh-keys
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-configure-clustering
        - integration-start-cluster-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*.log,*.log.xz,*.csv'
        - email-notification:
            email-prefix: '[{project}]'
        - plot:
          - title: '{01-plot-title}'
            yaxis: '{01-plot-yaxis}'
            group: '{01-plot-group}'
            num-builds: '5400'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-3node-{functionality}-{install}-{stream}-{01-plot-data-file}-history.csv'
            series:
              - file: '{01-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv
          - title: '{02-plot-title}'
            yaxis: '{02-plot-yaxis}'
            group: '{02-plot-group}'
            num-builds: '5400'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-3node-{functionality}-{install}-{stream}-{02-plot-data-file}-history.csv'
            series:
              - file: '{02-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv

- job-template:
    name: '{project}-csit-3node-periodic-{functionality}-{install}-{stream}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: '{branch}'
        - integration-distribution-stream:
            stream: '{stream}'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-scope:
            controller-scope: '{scope}'
        - integration-controller-features:
            controller-features: 'odl-jolokia,{install-features}'
        - integration-test-options:
            test-options: '{robot-options}'
        - integration-stream-test-plan:
            stream-test-plan: '{project}-{functionality}-{stream}.txt'
        - integration-test-plan:
            test-plan: '{project}-{functionality}.txt'
        - integration-patch-refspec:
            branch: 'master'
        - integration-jdk-version:
            jdkversion: '{jre}'

    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$PATCHREFSPEC'
            branch: 'master'

    wrappers:
        - integration-openstack-controller-mininet:
            controller-vms: 3
            mininet-image: '{mininet-image}'
            mininet-vms: '{mininet-vms}'
            mininet-cloud-name: '{mininet-cloud-name}'
        - ssh-agent-credentials:
            users:
                - '{ssh-credentials}'

    triggers:
        - timed: '{schedule}'

    builders:
        - integration-copy-ssh-keys
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-configure-clustering
        - integration-start-cluster-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*.log,*.log.xz,*.csv'
        - email-notification:
            email-prefix: '[{project}]'
        - plot:
          - title: '{01-plot-title}'
            yaxis: '{01-plot-yaxis}'
            group: '{01-plot-group}'
            num-builds: '5400'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-3node-periodic-{functionality}-{install}-{stream}-{01-plot-data-file}-history.csv'
            series:
              - file: '{01-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv
          - title: '{02-plot-title}'
            yaxis: '{02-plot-yaxis}'
            group: '{02-plot-group}'
            num-builds: '5400'
            style: line
            use-description: false
            csv-file-name: '{project}-csit-3node-periodic-{functionality}-{install}-{stream}-{02-plot-data-file}-history.csv'
            series:
              - file: '{02-plot-data-file}'
                inclusion-flag: 'off'
                display-table: true
                format: csv

- job-template:
    name: '{project}-openstack-{functionality}-daily-{openstack}-{odl}'

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-patch-refspec:
            branch: 'master'
        - integration-test-plan:
            test-plan: '{project}-{functionality}.txt'
        - string:
            name: OPENSTACK_BRANCH
            default: '{openstack-branch}'
            description: 'Openstack branch to use with devstack'
        - string:
            name: ODL_VERSION
            default: '{odl-version}'
            description: 'OpenDaylight version to use with devstack + networking_odl project'
        - string:
            name: TEMPEST_REGEX
            default: 'tempest.api.network'
            description: 'Default grouping of tempest tests to run'

    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$PATCHREFSPEC'
            branch: 'master'

    wrappers:
          - build-timeout
          - openstack:
              instances:
                - cloud-name: 'ODLRPC'
                  template-name: 'centos7-devstack'
                  count: '1'
          - ssh-agent-credentials:
              users:
                  - '{ssh-credentials}'

    # Trigger jobs (daily)
    triggers:
        - integration-csit-all

    builders:
        - integration-copy-ssh-keys
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - include-raw-integration-deploy-devstack-testing
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*log*'
        - email-notification:
            email-prefix: '[{project}]'

- job-template:
    name: '{project}-csit-1node-openstack-{openstack}-{functionality}-{stream}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: '{branch}'
        - integration-distribution-stream:
            stream: '{stream}'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-features:
            controller-features: '{install-features}'
        - integration-test-plan:
            test-plan: '{project}-1node-openstack.txt'
        - integration-patch-refspec:
            branch: 'master'
        - integration-jdk-version:
            jdkversion: '{jre}'
        - string:
            name: INSTALL_FEATURES
            default: '{install-features}'
            description: 'OpenDaylight features to install'
        - string:
            name: OPENSTACK_BRANCH
            default: '{openstack-branch}'
            description: 'Openstack version to use with devstack'
        - string:
            name: ODL_ML2_DRIVER_REPO
            default: 'https://github.com/openstack/networking-odl'
            description: 'URL to fetch networking-odl driver'
        - string:
            name: ODL_ML2_VERSION
            default: '{odl-ml2-version}'
            description: 'Version of networking-odl to checkout from the repo'
        - string:
            name: ODL_ENABLE_L3_FWD
            default: '{odl-enable-l3}'
            description: 'Enable L3 FWD in ODL for createing br-ex'
        - string:
            name: ENABLE_OS_SERVICES
            default: '{enable-openstack-services}'
            description: 'comma seperated list of services to enable'
        - string:
            name: DISABLE_OS_SERVICES
            default: '{disable-openstack-services}'
            description: 'comma seperated list of services to enable'
        - string:
            name: TENANT_NETWORK_TYPE
            default: '{tenant-network-type}'
            description: 'Tenant Network Type supported by the implementation'
    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$PATCHREFSPEC'
            branch: 'master'

    wrappers:
        - build-timeout
        - integration-openstack-controller-devstack:
            controller-vms: 1
            openstack-vms: '{openstack-vms}'
        - ssh-agent-credentials:
            users:
              - '{ssh-credentials}'

    triggers:
        - integration-csit-all

    builders:
        - integration-copy-ssh-keys
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-deploy-controller-run-test
        - integration-deploy-openstack-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*log*'
        - email-notification:
            email-prefix: '[{project}]'

- job-template:
    name: '{project}-csit-3node-openstack-{openstack}-{functionality}-{stream}'
    disabled: false

    project-type: freestyle
    node: dynamic_robot

    logrotate:
        daysToKeep: '{build-days-to-keep}'
        numToKeep: '{build-num-to-keep}'
        artifactDaysToKeep: '{build-artifact-days-to-keep}'
        artifactNumToKeep: '{build-num-to-keep}'

    parameters:
        - project-parameter:
            project: 'integration/test'
        - integration-branch:
            branch: '{branch}'
        - integration-distribution-stream:
            stream: '{stream}'
        - integration-bundleurl:
            bundleurl: 'last'
        - integration-controller-features:
            controller-features: 'odl-jolokia,{install-features}'
        - integration-test-plan:
            test-plan: '{project}-3node-openstack.txt'
        - integration-patch-refspec:
            branch: 'master'
        - integration-jdk-version:
            jdkversion: '{jre}'
        - string:
            name: OPENSTACK_BRANCH
            default: '{openstack-branch}'
            description: 'Openstack version to use with devstack'
        - string:
            name: ODL_ML2_DRIVER_REPO
            default: 'https://github.com/openstack/networking-odl'
            description: 'URL to fetch networking-odl driver'
        - string:
            name: ODL_ML2_VERSION
            default: '{odl-ml2-version}'
            description: 'Version of networking-odl to checkout from the repo'
        - string:
            name: ODL_ENABLE_L3_FWD
            default: '{odl-enable-l3}'
            description: 'Enable L3 FWD in ODL for createing br-ex'
        - string:
            name: ENABLE_HAPROXY_FOR_NEUTRON
            default: '{enable-haproxy}'
            description: 'Enable HAProxy for using neutron interface as HA'
        - string:
            name: ENABLE_OS_SERVICES
            default: '{enable-openstack-services}'
            description: 'comma seperated list of services to enable'
        - string:
            name: DISABLE_OS_SERVICES
            default: '{disable-openstack-services}'
            description: 'comma seperated list of services to enable'
        - string:
            name: TENANT_NETWORK_TYPE
            default: '{tenant-network-type}'
            description: 'Tenant Network Type supported by the implementation'
    scm:
        - integration-gerrit-scm:
            credentials-id: '{ssh-credentials}'
            basedir: 'test'
            refspec: '$PATCHREFSPEC'
            branch: 'master'

    wrappers:
        - build-timeout
        - integration-openstack-controller-devstack:
            controller-vms: 3
            openstack-vms: '{openstack-vms}'
        - ssh-agent-credentials:
            users:
              - '{ssh-credentials}'

    triggers:
        - integration-csit-all

    builders:
        - integration-copy-ssh-keys
        - integration-cleanup-workspace
        - integration-install-robotframework
        - inject:
            properties-file: 'env.properties'
        - integration-get-slave-addresses
        - inject:
            properties-file: 'slave_addresses.txt'
        - integration-get-bundle-vars
        - inject:
            properties-file: 'bundle_vars.txt'
        - integration-configure-clustering
        - integration-start-cluster-run-test
        - integration-deploy-openstack-run-test
        - integration-cleanup-tmp

    publishers:
        - integration-robot:
            unstable-if: 0.0
            pass-if: 100.0
        - archive:
            artifacts: '*log*'
        - email-notification:
            email-prefix: '[{project}]'
