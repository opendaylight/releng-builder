---
- project:
    name: autorelease-projects
    jobs:
      - autorelease-branch-cut
      - 'autorelease-generate-release-notes-{stream}'
      - 'autorelease-release-{stream}':
          build-node: centos7-autorelease-4c-16g
      - 'autorelease-update-validate-jobs-{stream}'
      - 'autorelease-version-bump-{stream}':
          build-node: centos7-autorelease-4c-16g
      - '{project-name}-validate-autorelease-{stream}'
      - gerrit-tox-verify

    # todo: After Carbon EOL remove next-release-tag and directy pass
    # '{stream}' to autorelease-release-tag parameter
    stream:
      - fluorine:
          next-release-tag: '{stream}'
          branch: 'master'
          integration-test: fluorine
          extra-mvn-opts: -P!karaf -Dsft.heap.max=4g
      - oxygen:
          # Run once a week (Sunday) until Nitrogen-SR3 is out.
          cron: 'H 12 * * 6'
          next-release-tag: '{stream}'
          branch: 'stable/oxygen'
          integration-test: oxygen
          extra-mvn-opts: -P!karaf -Dsft.heap.max=4g
      - nitrogen:
          next-release-tag: '{stream}'
          branch: 'stable/nitrogen'
          integration-test: nitrogen
          extra-mvn-opts: -P!karaf -Dsft.heap.max=4g

    project: releng/autorelease
    project-name: autorelease
    build-node: centos7-builder-2c-8g
    # Before adding more here, beware of https://jira.linuxfoundation.org/browse/RELENG-280
    archive-artifacts: >
        **/*.prop
        **/*.log
        **/target/surefire-reports/*-output.txt
        **/target/failsafe-reports/failsafe-summary.xml
        **/hs_err_*.log
        **/target/feature/feature.xml
    # TODO: **/*.hprof is too large, compress with xz first
