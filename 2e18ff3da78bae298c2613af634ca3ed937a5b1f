{
  "comments": [
    {
      "key": {
        "uuid": "c798b170_078fb845",
        "filename": "jjb/netvirt/netvirt-apex-images.yaml",
        "patchSetId": 19
      },
      "lineNbr": 10,
      "author": {
        "id": 5089
      },
      "writtenOn": "2018-08-20T19:23:50Z",
      "side": 1,
      "message": "Do you want there to be multiple jobs based on OS version? So one job for each branch to update all the images? Or do we want a single job that updates the images for all branches?\n\nIf we go with the former, then I think we also want a job per branch *and* topology (ha/noha/noha-allinone).",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 31
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c10c4a6d_a35ea3e2",
        "filename": "jjb/netvirt/netvirt-apex-images.yaml",
        "patchSetId": 19
      },
      "lineNbr": 10,
      "author": {
        "id": 773
      },
      "writtenOn": "2018-08-20T23:57:31Z",
      "side": 1,
      "message": "Do we continue with the upstream terminology or the downstream? Upstream there is no openstack ha, just odl ha and that is 3node or 1node.\n\nGuessing jamo only included pike for initial testing but will include queens also.\n\nI think it will be easiest if the image is promoted based on the OS branch - and nothing else. ODL will only promote a pike image if it passed all the topologies from apex - ha/no-ha/allinone - and then we bring that image in. Repeat for queens. This is only if we are not testing these images on the odl side, but if we do want to test on the odl side then I could see different topology jobs also.",
      "parentUuid": "c798b170_078fb845",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 31
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "26185ac9_d9665067",
        "filename": "jjb/netvirt/netvirt-apex-images.yaml",
        "patchSetId": 19
      },
      "lineNbr": 10,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "I think it probably makes sense to not over-engineer this\njob in to all the different branches and topologies. We\ncan just have this one job that handles it all for now. We\ncan optimize it later.",
      "parentUuid": "c10c4a6d_a35ea3e2",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 31
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2d1ac50a_aae46016",
        "filename": "jjb/netvirt/netvirt-apex-images.yaml",
        "patchSetId": 19
      },
      "lineNbr": 42,
      "author": {
        "id": 773
      },
      "writtenOn": "2018-08-20T23:57:31Z",
      "side": 1,
      "message": "weekly? or daily so we can pick up images quicker? Would be nice to also have a push notification from opnfv.",
      "range": {
        "startLine": 42,
        "startChar": 17,
        "endLine": 42,
        "endChar": 23
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "40160845_c81859ab",
        "filename": "jjb/netvirt/netvirt-apex-images.yaml",
        "patchSetId": 19
      },
      "lineNbr": 42,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "I don\u0027t know how interested we are in the quick updates or not. It doesn\u0027t hurt to run more or less frequently. it\u0027s\njust a VM in vexxhost running for a few cycles. You decide.",
      "parentUuid": "2d1ac50a_aae46016",
      "range": {
        "startLine": 42,
        "startChar": 17,
        "endLine": 42,
        "endChar": 23
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5d745552_f72add85",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 1,
      "author": {
        "id": 5089
      },
      "writtenOn": "2018-08-20T19:23:50Z",
      "side": 1,
      "message": "add:\nset -o errexit\nset -o nounset\nset -o pipefail",
      "range": {
        "startLine": 1,
        "startChar": 0,
        "endLine": 1,
        "endChar": 11
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b934ed28_e1d5f03c",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 1,
      "author": {
        "id": 773
      },
      "writtenOn": "2018-08-20T23:57:31Z",
      "side": 1,
      "message": "we usually use set -ex -o pipefail or set -xeu -o pipefail. Thought I see you copied an existing sh script which doesn\u0027t have it, so not biggie for now.",
      "parentUuid": "5d745552_f72add85",
      "range": {
        "startLine": 1,
        "startChar": 0,
        "endLine": 1,
        "endChar": 11
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "62eb885b_8566d5ed",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 1,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "check new ps.\n\nbut, the nounset flag has trouble with a venv, so can\u0027t use\nthat. I\u0027m no expert with these flags though, so maybe\nI\u0027m missing something.\n\nerror is:\n/tmp/v/openstack/bin/activate: line 57: PS1: unbound variable",
      "parentUuid": "b934ed28_e1d5f03c",
      "range": {
        "startLine": 1,
        "startChar": 0,
        "endLine": 1,
        "endChar": 11
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6de5ecd1_15a4156f",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 4,
      "author": {
        "id": 773
      },
      "writtenOn": "2018-08-20T23:57:31Z",
      "side": 1,
      "message": "2018 and Red Hat. Guess the first few lines are copied but the rest all seems new so the copyright should reflect that.",
      "range": {
        "startLine": 4,
        "startChar": 16,
        "endLine": 4,
        "endChar": 21
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3b205c70_e4c68a5c",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 4,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6de5ecd1_15a4156f",
      "range": {
        "startLine": 4,
        "startChar": 16,
        "endLine": 4,
        "endChar": 21
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e461ce4_1de785d3",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 24,
      "author": {
        "id": 5089
      },
      "writtenOn": "2018-08-20T19:23:50Z",
      "side": 1,
      "message": "here you need to download the latest properties and check if the checksum is different from the local checksum:\nhttps://github.com/opnfv/releng/blob/master/jjb/apex/apex-snapshot-deploy.sh#L28:L75",
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "94a73649_51a6ed36",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 24,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "added the checksum stuff as as TODO for now.",
      "parentUuid": "6e461ce4_1de785d3",
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b110194_387fb5f4",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 25,
      "author": {
        "id": 5089
      },
      "writtenOn": "2018-08-20T19:23:50Z",
      "side": 1,
      "message": "This should be the value determined from the properties file:\nhttps://github.com/opnfv/releng/blob/master/jjb/apex/apex-snapshot-deploy.sh#L63",
      "range": {
        "startLine": 25,
        "startChar": 25,
        "endLine": 25,
        "endChar": 89
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cd20a27d_fea0e7f2",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 25,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9b110194_387fb5f4",
      "range": {
        "startLine": 25,
        "startChar": 25,
        "endLine": 25,
        "endChar": 89
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "33697c96_a2ec6eff",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 26,
      "author": {
        "id": 5089
      },
      "writtenOn": "2018-08-20T19:23:50Z",
      "side": 1,
      "message": "you could save disk space by not decompressing this?",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 26,
        "endChar": 39
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eef00d8e_9ceb3d36",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 26,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "gotta uncompress so I can do the --delete trick below. it\ndoesn\u0027t work on compressed archives.",
      "parentUuid": "33697c96_a2ec6eff",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 26,
        "endChar": 39
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6a6b3cbb_d99ccaf4",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 36,
      "author": {
        "id": 5089
      },
      "writtenOn": "2018-08-20T19:23:50Z",
      "side": 1,
      "message": "need to change this logic to list the files in the archive\nThen iterate. Or if that takes too long, then can just decide on disk names based on topology type (ha, noha, etc).\n\nAlso need to pull out the node.yaml id_rsa and overcloudrc and push them into swift.",
      "range": {
        "startLine": 31,
        "startChar": 0,
        "endLine": 36,
        "endChar": 68
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8cbdddfb_f128f510",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 36,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6a6b3cbb_d99ccaf4",
      "range": {
        "startLine": 31,
        "startChar": 0,
        "endLine": 36,
        "endChar": 68
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8b9f0d59_f3911e8f",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 67,
      "author": {
        "id": 5089
      },
      "writtenOn": "2018-08-20T19:23:50Z",
      "side": 1,
      "message": "what if disk images already exist? Don\u0027t you need to delete them first, or use update command? Can you include the snapshot date in the image name so we know the latest in glance?",
      "range": {
        "startLine": 58,
        "startChar": 0,
        "endLine": 67,
        "endChar": 84
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5193c8fb_d4816240",
        "filename": "jjb/opendaylight-infra-apex-image-management.sh",
        "patchSetId": 19
      },
      "lineNbr": 67,
      "author": {
        "id": 2264
      },
      "writtenOn": "2018-08-25T00:57:05Z",
      "side": 1,
      "message": "we need to atomically (as best as possible) upload these\nimages to have the same name. The name needs to be generic\nthough, so no timestamp, because we would then have to go\nfile patches in our jobs to pick these new images based on\nthe new name. OR, make more complex logic in our stack create\nscripts.\n\nBUT, we can tag the images with dates. If we add an image\nshow command in the right places it will be fairly easy\nto figure it out whenever we need to. I\u0027ll add the name\nof the archive file (which has the date apex made it, as\nwell as the actual date we uploaded these in to vexxhost)",
      "parentUuid": "8b9f0d59_f3911e8f",
      "range": {
        "startLine": 58,
        "startChar": 0,
        "endLine": 67,
        "endChar": 84
      },
      "revId": "2e18ff3da78bae298c2613af634ca3ed937a5b1f",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}